import os
import magic
from datetime import datetime
from malware_scanner.utils import print_result

def extract_metadata(file_path):
    if not os.path.exists(file_path):
        print_result("File does not exist!", "error")
        return

    file_size = os.path.getsize(file_path)
    created = datetime.fromtimestamp(os.path.getctime(file_path))
    modified = datetime.fromtimestamp(os.path.getmtime(file_path))
    file_type = magic.from_file(file_path)

    print_result("[*] File Metadata:", "info")
    print(f"File Path: {file_path}")
    print(f"File Size: {file_size} bytes")
    print(f"Created: {created}")
    print(f"Modified: {modified}")
    print(f"Type: {file_type}")
