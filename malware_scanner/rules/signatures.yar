# check if the following rule is working or not, i will not comment for now because the 'pe' module is not sure if it is supported in this YARA build or causes syntax errors.
# If you face any errors, please comment out the signature.yar file and you are good to go.

rule Digital_Signature_PE
{
    meta:
         description = "Detects presence of digital signature in PE files"
        author = "Enhanced by MrAashish0x1"
         last_modified = "2025-09-14"

    condition:
         uint16(0) == 0x5A4D and for any i in (pe.number_of_rva_and_sizes) : (
             pe.data_directories[i].virtual_address != 0 and
             pe.data_directories[i].size != 0
         )
 }