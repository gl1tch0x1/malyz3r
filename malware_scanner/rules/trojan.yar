rule Trojan_Generic
{
    meta:
        description = "Detects common Trojan backdoor patterns"
        author = "MrAashish0x1"
        last_modified = "2025-09-14"

    strings:
    $cmd = "cmd.exe /c" ascii
    $powershell = "powershell -nop -w hidden" ascii
    $dll_inject = "VirtualAllocEx" ascii
    $c2_url = /http[s]?:\/\/[a-zA-Z0-9\.\/]+\/gate\.php/
    $regex1 = /powershell\s+-[eE]ncode[dD]\s+[A-Za-z0-9+/=]+/ ascii
    $regex2 = /[A-Za-z0-9]{20,}\.[a-z]{2,4}\/[A-Za-z0-9]{10,}/ ascii
    $mz = { 4D 5A } // 'MZ' header for PE files
    $dos = "This program cannot be run in DOS mode"

    condition:
        any of them
}
