
import os
import logging
from colorama import Fore, Style, init as colorama_init

# Only initialize colorama once
_colorama_initialized = False
def _ensure_colorama():
    global _colorama_initialized
    if not _colorama_initialized:
        colorama_init(autoreset=True)
        _colorama_initialized = True

LOG_FILE = os.environ.get("MALYZ3R_LOG_FILE", "malyz3r.log")
logger = logging.getLogger("malyz3r")
if not logger.hasHandlers():
    handler = logging.FileHandler(LOG_FILE)
    formatter = logging.Formatter('%(asctime)s %(levelname)s %(message)s')
    handler.setFormatter(formatter)
    logger.addHandler(handler)
    logger.setLevel(logging.INFO)

def print_result(message, level="info", log=True):
    _ensure_colorama()
    colors = {
        "info": Fore.CYAN,
        "success": Fore.GREEN,
        "error": Fore.RED,
        "danger": Fore.MAGENTA
    }
    color = colors.get(level, Fore.WHITE)
    print(color + message + Style.RESET_ALL)
    if log:
        if level == "error":
            logger.error(message)
        elif level == "success":
            logger.info("SUCCESS: " + message)
        elif level == "danger":
            logger.warning("DANGER: " + message)
        else:
            logger.info(message)
